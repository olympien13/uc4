---
- name: Deploy simple website using Ansible Lightspeed with watsonx Code Assistant
  hosts: all
  gather_facts: false
  remote_user: root
  become: true

  tasks:
    - name: Ensure httpd package is installed
      ansible.builtin.package:
        name: lighttpd
        state: present


    - name: Configure httpd on port 8080
      ansible.builtin.lineinfile:
        dest: /etc/lighttpd/lighttpd.conf
        regexp: ^server.port
        line: server.port             = 8080
        state: present


    # Start and enable firewalld & Allow the traffic through firewalld & reload firewalld & Ensure /var/www/html directory exists
    - name: Start and enable firewalld
      ansible.builtin.service:
        name: firewalld
        state: started
        enabled: true

    - name: Allow the traffic through firewalld
      ansible.posix.firewalld:
        port: "{{ _port_ }}"
        permanent: true
        state: enabled

    - name: Reload firewalld
      ansible.builtin.command: firewall-cmd --reload

    - name: Ensure /var/www/html directory exists
      ansible.builtin.file:
        path: /var/www/html
        state: directory
        mode: '07555'


    - name: Extract website-rh.tar.gz without remote_src and set permissions and ownership to root
    

    #- name: Start and enable httpd





